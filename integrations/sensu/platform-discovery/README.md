## Overview

<!-- Sensu Integration description; supports markdown -->

The Sensu Platform Discovery integration provides automated discovery of agent operating systems, and automated [subscription] management.

The following platforms are supported at this time:

- Linux (subscription: `linux`)
- Windows (subscription: `windows`)
- macOS (subscription: `darwin`)
- FreeBSD (subscription: `freebsd`)
- Solaris (subscription: `solaris`)

## Dashboards

<!-- List of compatible dashboards w/ screenshots (supports png, jpeg, and gif images; relative paths only; e.g. `![](img/dashboard-1.png)` )-->

<!-- This integration is compatible with the [{{dashboard_name}}][{{dashboard_link}}] (included w/ [Sensu Plus][sensu-plus]). -->

<!-- ![](img/dashboard.png) -->

There are no compatible dashboards for this integration.

## Setup

<!-- Sensu Integration setup instructions, including Sensu agent configuration and external component configuration -->
<!-- EXAMPLE: what configuration (if any) is required in a third-party service to enable monitoring? -->

1. **Add one of the following [subscriptions] to [agents] that should run this check.**

   * `discovery`
   * `autodiscovery`
   * `auto-discovery`
   * `platform-discovery`

1. **Create an API Key for use with this integration, optionally including a dedicated "service account" user.**

   Create an "entity-manager" service account (i.e. [role], [role-binding], and [user]):

   ```
   sensuctl role create entity-manager --verb=update --resource entities
   sensuctl role-binding create entity-manager --role=entity-manager --user=entity-manager
   sensuctl user create entity-manager --password $(openssl rand -hex 16)
   sensuctl api-key grant entity-manager
   ```

   _NOTE: "service account users should be used for automation purposes only, with api-keys for authentication.
   Generating and discarding a random password (e.g. `openssl rand -hex 16` or `uuid -v4`) is appropriate in this context._

   The `sensuctl api-key grant` command should produce a response containing a 36-character UUID v4 formatted string:

   ```
   Created: /api/core/v2/apikeys/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
   ```

   Copy the `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx` portion of the output.

   If you are unable to generate a `role`, `role-binding`, `user`, and/or `api-key`, please contact your Sensu administrator.


## Plugins

<!-- Links to any Sensu Integration dependencies (i.e. Sensu Plugins) -->

- [sensu/sensu-platform-discovery][sensu-platform-discovery-bonsai] ([GitHub][sensu-platform-discovery-github])
- [sensu/sensu-entity-manager][sensu-entity-manager-bonsai] ([GitHub][sensu-entity-manager-github])

## Metrics & Events

<!-- List of all metrics or events collected by this integration. -->

This integration does not produce any metrics.

## Alerts

<!-- List of all alerts generated by this integration. -->

This integration does not produce any alerts.
Discovery events are processed via the `entity-manager` pipeline, which updates entity subscriptions in real-time.

_NOTE: the default filters on the provided pipeline will only process the first discovery event produced by the discovery check; to trigger a subsequent entity update (e.g. if the API Key secret was initially invalid), simply delete the platform-discovery event for a given entity. The next time the check runs, the entity subscription update will be applied again._

## Reference Documentation

<!-- Please provide links to any relevant reference documentation to help users learn more and/or troubleshoot this integration; specifically including any third-party software documentation. -->

1. [Role-Based Access Controls (RBAC) for Sensu Go][rbac]
1. [Sensu Subscriptions][subscriptions]

<!-- Links -->
[check]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/checks/
[asset]: https://docs.sensu.io/sensu-go/latest/plugins/assets/
[subscription]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/subscriptions/
[subscriptions]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/subscriptions/
[agents]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/agent/
[annotation]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/agent/#general-configuration-flags
[plugins]: https://docs.sensu.io/sensu-go/latest/plugins/
[metrics]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/metrics/
[handler]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-process/handlers/
[pipeline]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-process/pipelines/
[secret]: https://docs.sensu.io/sensu-go/latest/operations/manage-secrets/secrets/
[secrets]: https://docs.sensu.io/sensu-go/latest/operations/manage-secrets/secrets/
[tokens]: https://docs.sensu.io/sensu-go/latest/observability-pipeline/observe-schedule/tokens/
[sensu-plus]: https://sensu.io/features/analytics
[sensu-platform-discovery-bonsai]: https://bonsai.sensu.io/assets/sensu/sensu-platform-discovery
[sensu-platform-discovery-github]: https://github.com/sensu/sensu-platform-discovery
[sensu-entity-manager-bonsai]: https://bonsai.sensu.io/assets/sensu/sensu-entity-manager
[sensu-entity-manager-github]: https://github.com/sensu/sensu-entity-manager
[role]: https://docs.sensu.io/sensu-go/latest/operations/control-access/rbac/#roles-and-cluster-roles
[role-binding]: https://docs.sensu.io/sensu-go/latest/operations/control-access/rbac/#role-bindings-and-cluster-role-bindings
[user]: https://docs.sensu.io/sensu-go/latest/operations/control-access/rbac/#users
[rbac]: https://docs.sensu.io/sensu-go/latest/operations/control-access/rbac/