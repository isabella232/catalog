---
api_version: catalog/v1
type: Integration
metadata:
  namespace: aws
  name: aws-sns-events
spec:
  class: supported
  provider: events
  display_name: AWS SNS Events
  short_description: Publishes Sensu Events as AWS SNS Messages
  supported_platforms:
    - darwin
    - linux
    - windows
  tags:
    - aws
  contributors:
    - "@sensu"
  prompts:
    - type: section
      title: AWS SNS Topic
    - type: markdown
      body: |
        This integration requires access to an AWS SNS Topic.
    - type: question
      name: aws_access_key_id
      input:
        type: string
        required: true
        title: AWS Access Key ID
    - type: question
      name: aws_secret_access_key
      input:
        type: string
        required: true
        title: AWS Secret Access Key
    - type: question
      name: aws_region
      input:
        type: string
        required: true
        title: AWS Region
        default: us-west-2
    - type: question
      name: sns_topic_arn
      input:
        type: string
        required: true
        title: AWS SNS Topic ARN
  resource_patches:
    - resource:
        api_version: core/v2
        type: Handler
        name: aws-sns-events
      patches:
        - path: /spec/env_vars/-
          op: add
          value: "AWS_SECRET_ACCESS_KEY=[[aws_secret_access_key]]"
        - path: /spec/env_vars/-
          op: add
          value: "AWS_ACCESS_KEY_ID=[[aws_access_key_id]]"
        - path: /spec/env_vars/-
          op: add
          value: "AWS_REGION=[[aws_region]]"
        - path: /spec/env_vars/-
          op: add
          value: "SNS_TOPIC_ARN=[[sns_topic_arn]]"
